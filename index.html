<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Playerjs by BPing</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Playerjs</h1>
      <h2 class="project-tagline">canvas player</h2>
      <a href="https://github.com/BPing/playerJs" class="btn">View on GitHub</a>
      <a href="https://github.com/BPing/playerJs/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/BPing/playerJs/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="playerjs" class="anchor" href="#playerjs" aria-hidden="true"><span class="octicon octicon-link"></span></a>playerJs</h1>

<p>canvas player</p>

<blockquote>
<blockquote>
<p>用canvas实现视频播放效果。当然，只能算是伪视频播放器，因为，它只是针对特定的数据格式。给每一个画图动作都赋予时间戳，一连贯的基于时间的画图动作呈现出来，再加上音频的同步播放，就有了视频播放的效果。</p>
</blockquote>
</blockquote>

<p><img src="https://github.com/BPing/playerJs/blob/dev/res/%E6%95%88%E6%9E%9C%E5%9B%BE.png?raw=true" alt="code Coverage"></p>

<h2>
<a id="目录" class="anchor" href="#%E7%9B%AE%E5%BD%95" aria-hidden="true"><span class="octicon octicon-link"></span></a><a name="index"></a>目录</h2>

<ul>
<li><a href="#project_dir">项目目录</a></li>
<li><a href="#project_compatibility">兼容性</a></li>
<li><a href="#video_use">使用</a></li>
<li><a href="#video_format">视频数据格式说明</a></li>
<li><a href="#**">**</a></li>
</ul>

<h2>
<a id="项目目录" class="anchor" href="#%E9%A1%B9%E7%9B%AE%E7%9B%AE%E5%BD%95" aria-hidden="true"><span class="octicon octicon-link"></span></a><a name="project_dir"></a>项目目录</h2>

<pre><code>playerJs/            --&gt; 
  css/              --&gt; css 文件 (*必须)
    index.css         --&gt; default stylesheet
  res/              --&gt; 资源文件，包括图片 (*必须)
    close.png        --&gt; 
    loading.gif      --&gt; 
  src/              --&gt; 
    coreJs.js        --&gt; 核心代码。数据解析， 视频播放，音频播放等处理
    playJs.js        --&gt; ui控制代码。根据相应的动作更新页面和监控页面事件
    utilJs.js        --&gt; 通用工具类。
  demo.json         --&gt; 视频数据示例
  example.html       --&gt; 例子
  player-*.min.js   --&gt; 源码压缩代码。所有js压缩，所以，使用时引用此文件即可 (*必须)
  video.html        --&gt; 播放器html  (*必须)
</code></pre>

<h2>
<a id="兼容性" class="anchor" href="#%E5%85%BC%E5%AE%B9%E6%80%A7" aria-hidden="true"><span class="octicon octicon-link"></span></a><a name="project_compatibility"></a>兼容性</h2>

<blockquote>
<ul>
<li>浏览器：IE9+  Edge12+  Chorme43+  firebox41+  Safari8+  Opera33+ <br>
</li>
<li>audio : mp3|wav  mp3 兼容性最好.<br>
</li>
<li>IE 不支持wav格式，但Edge支持。</li>
</ul>
</blockquote>

<h2>
<a id="使用" class="anchor" href="#%E4%BD%BF%E7%94%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a><a name="video_use"></a>使用</h2>

<div class="highlight highlight-source-js"><pre>
   <span class="pl-c">//html &lt;script type="text/javascript" src="XXX/player-0.9.min.js"&gt;&lt;/script&gt;</span>

    <span class="pl-smi">videoUI</span>.<span class="pl-en">startup</span>({
                  root<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>../<span class="pl-pds">'</span></span>,  <span class="pl-c">//此插件根目录</span>
                  url<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>,  <span class="pl-c">//视频数据来源</span>
                  volume<span class="pl-k">:</span> <span class="pl-c1">50</span>, <span class="pl-c">//默认音量大小。0-100</span>
                  <span class="pl-s"><span class="pl-pds">"</span>vw<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">600</span>, <span class="pl-c">//视口宽</span>
                  <span class="pl-s"><span class="pl-pds">"</span>vh<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">400</span>, <span class="pl-c">//视口高</span>
                  <span class="pl-s"><span class="pl-pds">"</span>cw<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">600</span>, <span class="pl-c">// 底层canvas宽</span>
                  <span class="pl-s"><span class="pl-pds">"</span>ch<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">3200</span>, <span class="pl-c">// 底层canvas高</span>
              });
</pre></div>

<h2>
<a id="视频数据格式说明" class="anchor" href="#%E8%A7%86%E9%A2%91%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E8%AF%B4%E6%98%8E" aria-hidden="true"><span class="octicon octicon-link"></span></a><a name="video_format"></a>视频数据格式说明</h2>

<p><img src="https://github.com/BPing/playerJs/blob/dev/res/size.png?raw=true" alt="code Coverage"></p>

<blockquote>
<blockquote>
<p>视频trace的格式定义:</p>

<p>第一行: 屏幕尺寸|trace版本</p>

<p>最后一行: 整个视频的时长.[毫秒]</p>

<p>回放 Trace 条目的定义...</p>

<p>timestamp&amp;(userType|screenOffset|action|color|pointX|pointY|time|pressure)</p>

<p>&amp;(userType|screenOffset|action|color|pointX|pointY|time|pressure)</p>

<p>单个条目详细解释如下:</p>

<p><code>timestamp</code> 当前操作的偏移时间[与连接开始的时间偏移], 由服务器设置</p>

<p>userType 当前数据来源</p>

<p><code>action</code> Down(0)|Move(2)|Up(1)|Cancel(3)|SCREEN_JUMP(5)|Image(9) 其中括号内的是具体的值.</p>

<p>color(AARRGGBB) int 值,当前点的颜色</p>

<p><code>pointX</code> 当前点的X值</p>

<p><code>pointY</code> 当前点的Y值</p>

<p>time 当前事件发生的时间</p>

<p>pressure 当前事件的压力.</p>

<p><code>screenOffset</code> 屏幕的偏移百分比, 相对于屏幕高度.[单屏高度为100]</p>

<p>Note:</p>

<p>关于 action 复用的定义如下.</p>

<p>当值为 [0,3] 时, 是正常的划线操作.</p>

<p>当值为 [5] 时, 是表示对屏幕的移动操作. 后面的字段全部不存在.</p>

<p>此时trace的格式为 <code>timestamp</code>|userType|<code>screenOffset</code>|<code>action</code></p>

<p>当值为 [9] 时, 是表示加入图片. 后面的字段全部不存在, 如果不够则继续添加.</p>

<p>格式如下: </p>

<p><code>图片名</code> * <code>pointX</code> * <code>pointY</code> * <code>模式mode</code> *  <code>屏幕索引screenIndex</code>|<code>图片名</code> * <code>pointX</code>  * <code>pointY</code> * <code>模式</code> * <code>屏幕索引</code>|<code>图片名</code> * <code>pointX</code> * <code>pointY</code> * <code>模式</code> * <code>屏幕索引</code>,</p>

<p>图片的索引从1开始</p>

<p>其中模式: [0: 铺满屏幕(最大一个页面)| 1: 按图片大小进行加载.(需根据屏幕比进行缩放)]</p>
</blockquote>
</blockquote>

<p><a href="https://github.com/BPing/playerJs/blob/dev/demo.json">demo.json</a>:</p>

<div class="highlight highlight-source-json"><pre>{
  <span class="pl-s"><span class="pl-pds">"</span>responseNo<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span>,  <span class="pl-ii">//返回码</span>

  <span class="pl-s"><span class="pl-pds">"</span>videoData<span class="pl-pds">"</span></span>: {  <span class="pl-ii">//视频数据</span>

    <span class="pl-s"><span class="pl-pds">"</span>imgPath<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>./res/<span class="pl-pds">"</span></span>,  <span class="pl-ii">//图片根目录</span>

    <span class="pl-s"><span class="pl-pds">"</span>audioUrl<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>./res/Audio.mp3<span class="pl-pds">"</span></span>,  <span class="pl-ii">//音频地址</span>
    <span class="pl-s"><span class="pl-pds">"</span>screenSize<span class="pl-pds">"</span></span>: {  <span class="pl-ii">//屏幕尺寸</span>
      <span class="pl-s"><span class="pl-pds">"</span>w<span class="pl-pds">"</span></span>: <span class="pl-c1">150</span>,
      <span class="pl-s"><span class="pl-pds">"</span>h<span class="pl-pds">"</span></span>: <span class="pl-c1">100</span>
    },

    <span class="pl-s"><span class="pl-pds">"</span>traceData<span class="pl-pds">"</span></span>: [  <span class="pl-ii">//帧数据</span>
      {
        <span class="pl-s"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span>: <span class="pl-c1">500</span>,  <span class="pl-ii">//时间戳</span>
        <span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>: [         <span class="pl-ii">//具体画图动作</span>
          {
            <span class="pl-s"><span class="pl-pds">"</span>userType<span class="pl-pds">"</span></span>: <span class="pl-c1">1</span>,
            <span class="pl-s"><span class="pl-pds">"</span>screenOffset<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span>, <span class="pl-ii">//</span> <span class="pl-ii">屏幕偏移。以页面值为100，也是一个视口的高度。</span> <span class="pl-ii">具体偏移量=</span> <span class="pl-ii">(screenOffset/100)*view.heigth</span>
            <span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span>: <span class="pl-c1">9</span>,   <span class="pl-ii">//画图片动作</span>
            <span class="pl-s"><span class="pl-pds">"</span>imgName<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>01201512021516100015.jpg<span class="pl-pds">"</span></span>, <span class="pl-ii">//图片名字。图片地址=imgPath+imgName</span>
            <span class="pl-s"><span class="pl-pds">"</span>pointX<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span>,  <span class="pl-ii">//画图起点X</span>
            <span class="pl-s"><span class="pl-pds">"</span>pointY<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span>,  <span class="pl-ii">//画图起点Y</span>
            <span class="pl-s"><span class="pl-pds">"</span>mode<span class="pl-pds">"</span></span>: <span class="pl-c1">1</span>,    <span class="pl-ii">//0：铺满一页，1：按图片大小缩放。Notice：无论哪种模式，图片至多显示在一个页面上</span>
            <span class="pl-s"><span class="pl-pds">"</span>screenIndex<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span> <span class="pl-ii">//页面偏移量，相对整个页面。假如screenIndex=</span><span class="pl-c1">1</span><span class="pl-ii">，则表示此图画在第二个页面，以此类推。</span>
            <span class="pl-ii">//**Notice**：一个视口的大小就是一个页面大小。</span>
          }
        ]
      },
      {
      <span class="pl-s"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span>: <span class="pl-c1">1000</span>, <span class="pl-ii">//时间戳</span>
        <span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>: [   <span class="pl-ii">//具体动作数据</span>
          {
            <span class="pl-s"><span class="pl-pds">"</span>userType<span class="pl-pds">"</span></span>: <span class="pl-c1">1</span>,
            <span class="pl-s"><span class="pl-pds">"</span>screenOffset<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span>,
            <span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span>,  <span class="pl-ii">//动作</span> <span class="pl-ii">0：按下画笔，2：画笔移动画线，1：移开画笔，停止画线</span>
            <span class="pl-s"><span class="pl-pds">"</span>pointX<span class="pl-pds">"</span></span>: <span class="pl-c1">75</span>,
            <span class="pl-s"><span class="pl-pds">"</span>pointY<span class="pl-pds">"</span></span>: <span class="pl-c1">60</span>,
          },
          ]
      }
       {
        <span class="pl-s"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span>: <span class="pl-c1">5500</span>,
        <span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>: [
          {
            <span class="pl-s"><span class="pl-pds">"</span>userType<span class="pl-pds">"</span></span>: <span class="pl-c1">1</span>,
            <span class="pl-s"><span class="pl-pds">"</span>screenOffset<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span>, <span class="pl-ii">//视口移动偏移量</span>
            <span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span>: <span class="pl-c1">5</span>  <span class="pl-ii">//视口移动</span>
          }
        ]
      }
     ],
     <span class="pl-s"><span class="pl-pds">"</span>duration<span class="pl-pds">"</span></span>: <span class="pl-c1">6000</span>  <span class="pl-ii">//视频总时间长</span> <span class="pl-ii">单位：毫秒</span>
    <span class="pl-ii">//**Notice**：</span><span class="pl-s"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span> <span class="pl-ii">相对视频始点的偏移时间戳，单位：毫秒</span>
   }
}</pre></div>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/BPing/playerJs">Playerjs</a> is maintained by <a href="https://github.com/BPing">BPing</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
